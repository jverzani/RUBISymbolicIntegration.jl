file_rules = [
#(* ::Subsection::Closed:: *)
#(* 1.2.3.1 (a+b x^n+c x^(2 n))^p *)
("1_2_3_1_1",
:(∫(((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~!n2))^(~!p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~x)) &&
    eq((~n2), 2*(~n)) &&
    lt((~n), 0) &&
    ext_isinteger((~p)) ?
∫((~x)^(2*(~n)*(~p))*((~c) + (~b)*(~x)^(-(~n)) + (~a)*(~x)^(-2*(~n)))^(~p), (~x)) : nothing))

("1_2_3_1_2",
:(∫(((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    isfraction((~n)) ?
let
    k = ext_den((~n))
    
    k*int_and_subst((~x)^(k - 1)*((~a) + (~b)*(~x)^(k*(~n)) + (~c)*(~x)^(2*k*(~n)))^(~p),  (~x), (~x), (~x)^(1⨸k), "1_2_3_1_2")
end : nothing))

("1_2_3_1_3",
:(∫(((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ilt((~n), 0) ?
-int_and_subst(((~a) + (~b)*(~x)^(-(~n)) + (~c)*(~x)^(-2*(~n)))^(~p)⨸(~x)^2,  (~x), (~x), 1⨸(~x), "1_2_3_1_3") : nothing))

("1_2_3_1_4",
:(∫(((~a) + (~!b)*(~x)^(~!n) + (~!c)*(~x)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) ?
((~a) + (~b)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^(~p)⨸((~b) + 2*(~c)*(~x)^(~n))^(2*(~p))* ∫(((~b) + 2*(~c)*(~x)^(~n))^(2*(~p)), (~x)) : nothing))

("1_2_3_1_5",
:(∫(((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    igt((~p), 0) ?
∫(ext_expand(((~a) + (~b)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^(~p), (~x)), (~x)) : nothing))

("1_2_3_1_6",
:(∫(((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ilt((~p), -1) ?
-(~x)*((~b)^2 - 2*(~a)*(~c) + (~b)*(~c)*(~x)^(~n))*((~a) + (~b)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^((~p) + 1)⨸((~a)* (~n)*((~p) + 1)*((~b)^2 - 4*(~a)*(~c))) + 1⨸((~a)*(~n)*((~p) + 1)*((~b)^2 - 4*(~a)*(~c)))* ∫(((~b)^2 - 2*(~a)*(~c) + (~n)*((~p) + 1)*((~b)^2 - 4*(~a)*(~c)) + (~b)*(~c)*((~n)*(2*(~p) + 3) + 1)*(~x)^(~n))*((~a) + (~b)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^((~p) + 1), (~x)) : nothing))

("1_2_3_1_7",
:(∫(1/((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~n2)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    igt((~n)/2, 0) &&
    neg((~b)^2 - 4*(~a)*(~c)) ?
let
    q = rt((~a)⨸(~c), 2)
    r = rt(2*q - (~b)⨸(~c), 2)
    
    1⨸(2*(~c)*q*r)*∫((r - (~x)^((~n)⨸2))⨸(q - r*(~x)^((~n)⨸2) + (~x)^(~n)), (~x)) + 1⨸(2*(~c)*q*r)*∫((r + (~x)^((~n)⨸2))⨸(q + r*(~x)^((~n)⨸2) + (~x)^(~n)), (~x))
end : nothing))

("1_2_3_1_8",
:(∫(1/((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~n2)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) ?
let
    q = rt((~b)^2 - 4*(~a)*(~c), 2)
    
    (~c)⨸q*∫(1⨸((~b)⨸2 - q⨸2 + (~c)*(~x)^(~n)), (~x)) - (~c)⨸q*∫(1⨸((~b)⨸2 + q⨸2 + (~c)*(~x)^(~n)), (~x))
end : nothing))

("1_2_3_1_9",
:(∫(((~a) + (~!b)*(~x)^(~n) + (~!c)*(~x)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
(~a)^intpart((~p))*((~a) + (~b)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^fracpart((~p))⨸ ((1 + 2*(~c)*(~x)^(~n)⨸((~b) + rt((~b)^2 - 4*(~a)*(~c), 2)))^ fracpart((~p))*(1 + 2*(~c)*(~x)^(~n)⨸((~b) - rt((~b)^2 - 4*(~a)*(~c), 2)))^fracpart((~p)))* ∫((1 + 2*(~c)*(~x)^(~n)⨸((~b) + sqrt((~b)^2 - 4*(~a)*(~c))))^ (~p)*(1 + 2*(~c)*(~x)^(~n)⨸((~b) - sqrt((~b)^2 - 4*(~a)*(~c))))^(~p), (~x)) : nothing))

("1_2_3_1_10",
:(∫(((~a) + (~!b)*(~u)^(~n) + (~!c)*(~u)^(~!n2))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    linear((~u), (~x)) &&
    !eq((~u), (~x)) ?
1⨸ext_coeff((~u), (~x), 1)* int_and_subst(((~a) + (~b)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^(~p),  (~x), (~x), (~u), "1_2_3_1_10") : nothing))

("1_2_3_1_11",
:(∫(((~a) + (~!b)*(~x)^(~mn) + (~!c)*(~x)^(~!n))^(~!p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~x)) &&
    eq((~mn), -(~n)) &&
    ext_isinteger((~p)) &&
    pos((~n)) ?
∫(((~b) + (~a)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^(~p)⨸(~x)^((~n)*(~p)), (~x)) : nothing))

("1_2_3_1_12",
:(∫(((~a) + (~!b)*(~x)^(~mn) + (~!c)*(~x)^(~!n))^(~p),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~n), (~p), (~x)) &&
    eq((~mn), -(~n)) &&
    !(ext_isinteger((~p))) &&
    pos((~n)) ?
(~x)^((~n)*fracpart((~p)))*((~a) + (~b)*(~x)^(-(~n)) + (~c)*(~x)^(~n))^ fracpart((~p))⨸((~b) + (~a)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^fracpart((~p))* ∫(((~b) + (~a)*(~x)^(~n) + (~c)*(~x)^(2*(~n)))^(~p)⨸(~x)^((~n)*(~p)), (~x)) : nothing))


]
