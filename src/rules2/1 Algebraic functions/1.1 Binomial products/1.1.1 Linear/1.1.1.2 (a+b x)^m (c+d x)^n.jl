# \((".*?"),\n@rule (∫(.|\n)*?)=>((.|\n)*?: nothing\))
# ($1,\n:($2) => :($4)



file_rules = [
#(* ::Subsection::Closed:: *)
#(* 1.1.1.2 (a+b x)^m (c+d x)^n *)
("1_1_1_2_1",
:(∫(((~a) + (~!b)*(~x))^(~!m)*((~c) + (~!d)*(~x)),(~x))) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
    eq((~a)*(~d) - (~b)*(~c)*((~m) + 2), 0) ?
(~d)*(~x)*((~a) + (~b)*(~x))^((~m) + 1)⨸((~b)*((~m) + 2)) : nothing))

("1_1_1_2_2",
:(∫(1/(((~a) + (~!b)*(~x))*((~c) + (~!d)*(~x))),(~x))) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) ?
∫(1⨸((~a)*(~c) + (~b)*(~d)*(~x)^2), (~x)) : nothing))

("1_1_1_2_3",
:(∫(1/(((~!a) + (~!b)*(~x))*((~!c) + (~!d)*(~x))),(~x))) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) ?
(~b)⨸((~b)*(~c) - (~a)*(~d))*∫(1⨸((~a) + (~b)*(~x)), (~x)) - (~d)⨸((~b)*(~c) - (~a)*(~d))*∫(1⨸((~c) + (~d)*(~x)), (~x)) : nothing))

("1_1_1_2_4",
:(∫(((~!a) + (~!b)*(~x))^(~!m)*((~!c) + (~!d)*(~x))^(~n),(~x))) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~m) + (~n) + 2, 0) &&
    !eq((~m), -1) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~n) + 1)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1)) : nothing))

("1_1_1_2_5",
:(∫(((~a) + (~!b)*(~x))^(~m::P_igt_x_plus_half)*((~c) + (~!d)*(~x))^(~m::P_igt_x_plus_half),(~x))) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) ?
(~x)*((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~m)⨸(2*(~m) + 1) + 2*(~a)*(~c)*(~m)⨸(2*(~m) + 1)*∫(((~a) + (~b)*(~x))^((~m) - 1)*((~c) + (~d)*(~x))^((~m) - 1), (~x)) : nothing))

("1_1_1_2_6",
:(∫(1/(((~a) + (~!b)*(~x))^(3//2)*((~c) + (~!d)*(~x))^(3//2)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) ?
(~x)⨸((~a)*(~c)*sqrt((~a) + (~b)*(~x))*sqrt((~c) + (~d)*(~x))) : nothing))

("1_1_1_2_7",
:(∫(((~a) + (~!b)*(~x))^(~m::P_ilt_x_plus_3half)*((~c) + (~!d)*(~x))^(~m::P_ilt_x_plus_3half),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) ?
-(~x)*((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~m) + 1)⨸(2*(~a)*(~c)*((~m) + 1)) + (2*(~m) + 3)⨸(2*(~a)*(~c)*((~m) + 1))* ∫(((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~m) + 1), (~x)) : nothing))

("1_1_1_2_8",
:(∫(((~a) + (~!b)*(~x))^(~!m)*((~c) + (~!d)*(~x))^(~!m),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    (
        ext_isinteger((~m)) ||
        gt((~a), 0) &&
        gt((~c), 0)
    ) ?
∫(((~a)*(~c) + (~b)*(~d)*(~x)^2)^(~m), (~x)) : nothing))

("1_1_1_2_9",
:(∫(((~a) + (~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~m),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    !(ext_isinteger(2*(~m))) ?
((~a) + (~b)*(~x))^ fracpart((~m))*((~c) + (~d)*(~x))^fracpart((~m))⨸((~a)*(~c) + (~b)*(~d)*(~x)^2)^fracpart((~m))* ∫(((~a)*(~c) + (~b)*(~d)*(~x)^2)^(~m), (~x)) : nothing))

("1_1_1_2_10",
:(∫(((~!a) + (~!b)*(~x))^(~m::P_ilt_x_neg1)*((~!c) + (~!d)*(~x))^(~n::P_gt_0),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !(ext_isinteger((~n))) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^(~n)⨸((~b)*((~m) + 1)) - (~d)*(~n)⨸((~b)*((~m) + 1))*∫(((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~n) - 1), (~x)) : nothing))

("1_1_1_2_11",
:(∫(((~!a) + (~!b)*(~x))^(~m::P_ilt_x_neg1)*((~!c) + (~!d)*(~x))^(~n::P_lt_x_0),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !(ext_isinteger((~n))) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~n) + 1)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1)) - (~d)*((~m) + (~n) + 2)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1))* ∫(((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^(~n), (~x)) : nothing))

("1_1_1_2_12",
:(∫(((~!a) + (~!b)*(~x))^(~!m)*((~!c) + (~!d)*(~x))^(~!n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    igt((~m), 0) &&
    (
        !(ext_isinteger((~n))) ||
        eq((~c), 0) &&
        le(7*(~m) + 4*(~n) + 4, 0) ||
        lt(9*(~m) + 5*((~n) + 1), 0) ||
        gt((~m) + (~n) + 2, 0)
    ) ?
∫(ext_expand(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~n), (~x)), (~x)) : nothing))

("1_1_1_2_13",
:(∫(((~a) + (~!b)*(~x))^(~m::P_ilt_x_0)*((~!c) + (~!d)*(~x))^(~!n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~n)) &&
    !(
        igt((~n), 0) &&
        lt((~m) + (~n) + 2, 0)
    ) ?
∫(ext_expand(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~n), (~x)), (~x)) : nothing))

("1_1_1_2_14",
:(∫(((~!a) + (~!b)*(~x))^(~m)*((~!c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ilt(_simplify((~m) + (~n) + 2), 0) &&
    !eq((~m), -1) &&
    !(
        lt((~m), -1) &&
        lt((~n), -1) &&
        (
            eq((~a), 0) ||
            !eq((~c), 0) &&
            lt((~m) - (~n), 0) &&
            ext_isinteger((~n))
        )
    ) &&
    (
        sumsimpler((~m), 1) ||
        !(sumsimpler((~n), 1))
    ) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~n) + 1)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1)) - (~d)*_simplify((~m) + (~n) + 2)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1))* ∫(((~a) + (~b)*(~x))^_simplify((~m) + 1)*((~c) + (~d)*(~x))^(~n), (~x)) : nothing))

("1_1_1_2_15",
:(∫(1/(((~a) + (~!b)*(~x))^(9//4)*((~c) + (~!d)*(~x))^(1//4)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    neg((~a)^2*(~b)^2) ?
-4⨸(5*(~b)*((~a) + (~b)*(~x))^(5⨸4)*((~c) + (~d)*(~x))^(1⨸4)) - (~d)⨸(5*(~b))*∫(1⨸(((~a) + (~b)*(~x))^(5⨸4)*((~c) + (~d)*(~x))^(5⨸4)), (~x)) : nothing))

("1_1_1_2_16",
:(∫(((~!a) + (~!b)*(~x))^(~m)*((~!c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    gt((~n), 0) &&
    lt((~m), -1) &&
    !(
        ext_isinteger((~n)) &&
        !(ext_isinteger((~m)))
    ) &&
    !(
        ile((~m) + (~n) + 2, 0) &&
        (
            isfraction((~m)) ||
            ge(2*(~n) + (~m) + 1, 0)
        )
    ) &&
    int_linear((~a), (~b), (~c), (~d), (~m), (~n), (~x)) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^(~n)⨸((~b)*((~m) + 1)) - (~d)*(~n)⨸((~b)*((~m) + 1))*∫(((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~n) - 1), (~x)) : nothing))

("1_1_1_2_17",
:(∫(1/(((~a) + (~!b)*(~x))^(5//4)*((~c) + (~!d)*(~x))^(1//4)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    neg((~a)^2*(~b)^2) ?
-2⨸((~b)*((~a) + (~b)*(~x))^(1⨸4)*((~c) + (~d)*(~x))^(1⨸4)) + (~c)*∫(1⨸(((~a) + (~b)*(~x))^(5⨸4)*((~c) + (~d)*(~x))^(5⨸4)), (~x)) : nothing))

("1_1_1_2_18",
:(∫(((~a) + (~!b)*(~x))^(~m::P_igt_x_plus_half)*((~c) + (~!d)*(~x))^(~n::P_igt_x_plus_half),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    lt((~m), (~n)) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^(~n)⨸((~b)*((~m) + (~n) + 1)) + 2*(~c)*(~n)⨸((~m) + (~n) + 1)*∫(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^((~n) - 1), (~x)) : nothing))

("1_1_1_2_19",
:(∫(((~!a) + (~!b)*(~x))^(~m)*((~!c) + (~!d)*(~x))^(~n::P_gt_0),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~m) + (~n) + 1, 0) &&
    !(
        igt((~m), 0) &&
        (
            !(ext_isinteger((~n))) ||
            gt((~m), 0) &&
            lt((~m) - (~n), 0)
        )
    ) &&
    !(ilt((~m) + (~n) + 2, 0)) &&
    int_linear((~a), (~b), (~c), (~d), (~m), (~n), (~x)) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^(~n)⨸((~b)*((~m) + (~n) + 1)) + (~n)*((~b)*(~c) - (~a)*(~d))⨸((~b)*((~m) + (~n) + 1))* ∫(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^((~n) - 1), (~x)) : nothing))

("1_1_1_2_20",
:(∫(((~!a) + (~!b)*(~x))^(~m::P_lt_x_neg1)*((~!c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !(
        lt((~n), -1) &&
        (
            eq((~a), 0) ||
            !eq((~c), 0) &&
            lt((~m) - (~n), 0) &&
            ext_isinteger((~n))
        )
    ) &&
    int_linear((~a), (~b), (~c), (~d), (~m), (~n), (~x)) ?
((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^((~n) + 1)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1)) - (~d)*((~m) + (~n) + 2)⨸(((~b)*(~c) - (~a)*(~d))*((~m) + 1))* ∫(((~a) + (~b)*(~x))^((~m) + 1)*((~c) + (~d)*(~x))^(~n), (~x)) : nothing))

("1_1_1_2_21",
:(∫(1/(sqrt((~a::P_gt_0) + (~!b)*(~x))*sqrt((~c) + (~!d)*(~x))),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~a) + (~c), 0) &&
    eq((~b) - (~d), 0) ?
acosh((~b)*(~x)⨸(~a))⨸(~b) : nothing))

("1_1_1_2_22",
:(∫(1/(sqrt((~a) + (~!b)*(~x))*sqrt((~!c) + (~!d)*(~x))),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~b) + (~d), 0) &&
    gt((~a) + (~c), 0) ?
∫(1⨸sqrt((~a)*(~c) - (~b)*((~a) - (~c))*(~x) - (~b)^2*(~x)^2), (~x)) : nothing))

("1_1_1_2_23",
:(∫(1/(sqrt((~!a) + (~!b::P_gt_0)*(~x))*sqrt((~!c) + (~!d)*(~x))),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    gt((~b)*(~c) - (~a)*(~d), 0) ?
    2⨸sqrt((~b))* int_and_subst(1⨸sqrt((~b)*(~c) - (~a)*(~d) + (~d)*(~x)^2),  (~x), (~x), sqrt((~a) + (~b)*(~x)), "1_1_1_2_23") : nothing))

("1_1_1_2_24",
:(∫(1/(((~!a) + (~!b)*(~x))*((~!c) + (~!d)*(~x))^(1//3)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    pos(((~b)*(~c) - (~a)*(~d))/(~b)) ?
let
    q = rt(((~b)*(~c) - (~a)*(~d))⨸(~b), 3)
    -log((~a) + (~b)*(~x))⨸(2*(~b)*q) - 3⨸(2*(~b)*q)*int_and_subst(1⨸(rt(((~b)*(~c) - (~a)*(~d))⨸(~b),  3) - (~x)), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_24") + 3⨸(2*(~b))* int_and_subst(1⨸(rt(((~b)*(~c) - (~a)*(~d))⨸(~b),  3)^2 + q*(~x) + (~x)^2), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_24")
end : nothing))

("1_1_1_2_25",
:(∫(1/(((~!a) + (~!b)*(~x))*((~!c) + (~!d)*(~x))^(1//3)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    neg(((~b)*(~c) - (~a)*(~d))/(~b)) ?
log((~a) + (~b)*(~x))⨸(2*(~b)*rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3)) - 3⨸(2*(~b)*rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3))*int_and_subst(1⨸(rt(-((~b)*(~c) - (~a)*(~d))⨸(~b),  3) + (~x)), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_25") + 3⨸(2*(~b))* int_and_subst(1⨸(rt(-((~b)*(~c) - (~a)*(~d))⨸(~b),  3)^2 - rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3)*(~x) + (~x)^2), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_25") : nothing))

("1_1_1_2_26",
:(∫(1/(((~!a) + (~!b)*(~x))*((~!c) + (~!d)*(~x))^(2//3)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    pos(((~b)*(~c) - (~a)*(~d))/(~b)) ?
-log((~a) + (~b)*(~x))⨸(2*(~b)*rt(((~b)*(~c) - (~a)*(~d))⨸(~b), 3)^2) - 3⨸(2*(~b)*rt(((~b)*(~c) - (~a)*(~d))⨸(~b), 3)^2)*int_and_subst(1⨸(rt(((~b)*(~c) - (~a)*(~d))⨸(~b),  3) - (~x)), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_26") - 3⨸(2*(~b)*rt(((~b)*(~c) - (~a)*(~d))⨸(~b), 3))* int_and_subst(1⨸(rt(((~b)*(~c) - (~a)*(~d))⨸(~b),  3)^2 + rt(((~b)*(~c) - (~a)*(~d))⨸(~b), 3)*(~x) + (~x)^2), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_26") : nothing))

("1_1_1_2_27",
:(∫(1/(((~!a) + (~!b)*(~x))*((~!c) + (~!d)*(~x))^(2//3)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    neg(((~b)*(~c) - (~a)*(~d))/(~b)) ?
-log((~a) + (~b)*(~x))⨸(2*(~b)*rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3)^2) + 3⨸(2*(~b)*rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3)^2)*int_and_subst(1⨸(rt(-((~b)*(~c) - (~a)*(~d))⨸(~b),  3) + (~x)), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_27") + 3⨸(2*(~b)*rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3))* int_and_subst(1⨸(rt(-((~b)*(~c) - (~a)*(~d))⨸(~b),  3)^2 - rt(-((~b)*(~c) - (~a)*(~d))⨸(~b), 3)*(~x) + (~x)^2), (~x), (~x), ((~c) + (~d)*(~x))^(1⨸3), "1_1_1_2_27") : nothing))

("1_1_1_2_28",
:(∫(1/(((~!a) + (~!b)*(~x))^(1//3)*((~!c) + (~!d)*(~x))^(2//3)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    pos((~d)/(~b)) ?
-sqrt(3)*rt((~d)⨸(~b), 3)⨸(~d)* atan(2*rt((~d)⨸(~b), 3)*((~a) + (~b)*(~x))^(1⨸3)⨸(sqrt(3)*((~c) + (~d)*(~x))^(1⨸3)) + 1⨸sqrt(3)) - rt((~d)⨸(~b), 3)⨸(2*(~d))*log((~c) + (~d)*(~x)) - 3*rt((~d)⨸(~b), 3)⨸(2*(~d))*log(rt((~d)⨸(~b), 3)*((~a) + (~b)*(~x))^(1⨸3)⨸((~c) + (~d)*(~x))^(1⨸3) - 1) : nothing))

("1_1_1_2_29",
:(∫(1/(((~!a) + (~!b)*(~x))^(1//3)*((~!c) + (~!d)*(~x))^(2//3)),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    neg((~d)/(~b)) ?
sqrt(3)*rt(-(~d)⨸(~b), 3)⨸(~d)* atan(1⨸sqrt(3) - 2*rt(-(~d)⨸(~b), 3)*((~a) + (~b)*(~x))^(1⨸3)⨸(sqrt(3)*((~c) + (~d)*(~x))^(1⨸3))) + rt(-(~d)⨸(~b), 3)⨸(2*(~d))*log((~c) + (~d)*(~x)) + 3*rt(-(~d)⨸(~b), 3)⨸(2*(~d))*log(rt(-(~d)⨸(~b), 3)*((~a) + (~b)*(~x))^(1⨸3)⨸((~c) + (~d)*(~x))^(1⨸3) + 1) : nothing))

("1_1_1_2_30",
:(∫(((~!a) + (~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~m),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    lt(-1, (~m), 0) &&
    le(3, ext_den((~m)), 4) &&
    atom((~b)*(~c) + (~a)*(~d)) ?
((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~m)⨸((~a)*(~c) + ((~b)*(~c) + (~a)*(~d))*(~x) + (~b)*(~d)*(~x)^2)^(~m)* ∫(((~a)*(~c) + ((~b)*(~c) + (~a)*(~d))*(~x) + (~b)*(~d)*(~x)^2)^(~m), (~x)) : nothing))

("1_1_1_2_31",
:(∫(((~!a) + (~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~m),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    lt(-1, (~m), 0) &&
    le(3, ext_den((~m)), 4) ?
((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~m)⨸(((~a) + (~b)*(~x))*((~c) + (~d)*(~x)))^(~m)* ∫(((~a)*(~c) + ((~b)*(~c) + (~a)*(~d))*(~x) + (~b)*(~d)*(~x)^2)^(~m), (~x)) : nothing))

("1_1_1_2_32",
:(∫(((~!a) + (~!b)*(~x))^(~m::P_lt_neg1_x_0)*((~!c) + (~!d)*(~x))^(~n::P_le_neg1_x_0),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    le(ext_den((~n)), ext_den((~m))) &&
    int_linear((~a), (~b), (~c), (~d), (~m), (~n), (~x)) ?
ext_den((~m))⨸(~b)* int_and_subst((~x)^(ext_den((~m))*((~m) + 1) - 1)*((~c) - (~a)*(~d)⨸(~b) + (~d)*(~x)^ext_den((~m))⨸(~b))^(~n),  (~x), (~x), ((~a) + (~b)*(~x))^(1⨸ext_den((~m))), "1_1_1_2_32") : nothing))

("1_1_1_2_33",
:(∫(((~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~b), (~c), (~d), (~m), (~n), (~x)) &&
    !(ext_isinteger((~m))) &&
    (
        ext_isinteger((~n)) ||
        gt((~c), 0) &&
        !(
            eq((~n), -1/2) &&
            eq((~c)^2 - (~d)^2, 0) &&
            gt(-(~d)/((~b)*(~c)), 0)
        )
    ) ?
(~c)^(~n)*((~b)*(~x))^((~m) + 1)⨸((~b)*((~m) + 1))* hypergeometric2f1(-(~n), (~m) + 1, (~m) + 2, -(~d)*(~x)⨸(~c)) : nothing))

("1_1_1_2_34",
:(∫(((~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~b), (~c), (~d), (~m), (~n), (~x)) &&
    !(ext_isinteger((~n))) &&
    (
        ext_isinteger((~m)) ||
        gt(-(~d)/((~b)*(~c)), 0)
    ) ?
((~c) + (~d)*(~x))^((~n) + 1)⨸((~d)*((~n) + 1)*(-(~d)⨸((~b)*(~c)))^(~m))* hypergeometric2f1(-(~m), (~n) + 1, (~n) + 2, 1 + (~d)*(~x)⨸(~c)) : nothing))

("1_1_1_2_35",
:(∫(((~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~b), (~c), (~d), (~m), (~n), (~x)) &&
    !(ext_isinteger((~m))) &&
    !(ext_isinteger((~n))) &&
    !(gt((~c), 0)) &&
    !(gt(-(~d)/((~b)*(~c)), 0)) &&
    (
        isrational((~m)) &&
        !(
            eq((~n), -1/2) &&
            eq((~c)^2 - (~d)^2, 0)
        ) ||
        !(isrational((~n)))
    ) ?
(~c)^intpart((~n))*((~c) + (~d)*(~x))^fracpart((~n))⨸(1 + (~d)*(~x)⨸(~c))^fracpart((~n))* ∫(((~b)*(~x))^(~m)*(1 + (~d)*(~x)⨸(~c))^(~n), (~x)) : nothing))

("1_1_1_2_36",
:(∫(((~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~b), (~c), (~d), (~m), (~n), (~x)) &&
    !(ext_isinteger((~m))) &&
    !(ext_isinteger((~n))) &&
    !(gt((~c), 0)) &&
    !(gt(-(~d)/((~b)*(~c)), 0)) ?
(-(~b)*(~c)⨸(~d))^intpart((~m))*((~b)*(~x))^fracpart((~m))⨸(-(~d)*(~x)⨸(~c))^fracpart((~m))* ∫((-(~d)*(~x)⨸(~c))^(~m)*((~c) + (~d)*(~x))^(~n), (~x)) : nothing))

("1_1_1_2_37",
:(∫(((~a) + (~!b)*(~x))^(~m::(!ext_isinteger))*((~c) + (~!d)*(~x))^(~n::ext_isinteger),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) ?
((~b)*(~c) - (~a)*(~d))^(~n)*((~a) + (~b)*(~x))^((~m) + 1)⨸((~b)^((~n) + 1)*((~m) + 1))* hypergeometric2f1(-(~n), (~m) + 1, (~m) + 2, -(~d)*((~a) + (~b)*(~x))⨸((~b)*(~c) - (~a)*(~d))) : nothing))

("1_1_1_2_38",
:(∫(((~a) + (~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !(ext_isinteger((~m))) &&
    !(ext_isinteger((~n))) &&
    gt((~b)/((~b)*(~c) - (~a)*(~d)), 0) &&
    (
        isrational((~m)) ||
        !(
            isrational((~n)) &&
            gt(-(~d)/((~b)*(~c) - (~a)*(~d)), 0)
        )
    ) ?
((~a) + (~b)*(~x))^((~m) + 1)⨸((~b)*((~m) + 1)*((~b)⨸((~b)*(~c) - (~a)*(~d)))^(~n))* hypergeometric2f1(-(~n), (~m) + 1, (~m) + 2, -(~d)*((~a) + (~b)*(~x))⨸((~b)*(~c) - (~a)*(~d))) : nothing))

("1_1_1_2_39",
:(∫(((~a) + (~!b)*(~x))^(~m)*((~c) + (~!d)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !(ext_isinteger((~m))) &&
    !(ext_isinteger((~n))) &&
    (
        isrational((~m)) ||
        !(simpler((~n) + 1, (~m) + 1))
    ) ?
((~c) + (~d)*(~x))^ fracpart( (~n))⨸(((~b)⨸((~b)*(~c) - (~a)*(~d)))^intpart((~n))*((~b)*((~c) + (~d)*(~x))⨸((~b)*(~c) - (~a)*(~d)))^ fracpart((~n)))* ∫(((~a) + (~b)*(~x))^(~m)*simp((~b)*(~c)⨸((~b)*(~c) - (~a)*(~d)) + (~b)*(~d)*(~x)⨸((~b)*(~c) - (~a)*(~d)), (~x))^(~n), (~x)) : nothing))

("1_1_1_2_40",
:(∫(((~!a) + (~!b)*(~u))^(~!m)*((~!c) + (~!d)*(~u))^(~!n),(~x)) ) => :(
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    linear((~u), (~x)) &&
    !eq(ext_coeff((~u), (~x), 0), 0) ?
1⨸ext_coeff((~u), (~x), 1)* int_and_subst(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~n),  (~x), (~x), (~u), "1_1_1_2_40") : nothing))

#(* IntLinearQ[a,b,c,d,m,n,x] returns True iff (a+b*x)^m*(c+d*x)^n is  integrable wrt x in terms of non-hypergeometric functions. *) IntLinearQ[a_, b_, c_, d_, m_, n_, x_] := IGtQ[m, 0] || IGtQ[n, 0] || IntegersQ[3*m, 3*n] || IntegersQ[4*m, 4*n] || IntegersQ[2*m, 6*n] || IntegersQ[6*m, 2*n] || ILtQ[m + n, -1] || IntegerQ[m + n] && RationalQ[m]

]
