file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.7.7 F^(c (a+b x)) trig(d+e*x)^n *)
("4_7_7_1",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x)),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) ?
(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* sin((~d) + (~e)*(~x))⨸((~e)^2 + (~b)^2*(~c)^2*log((~F))^2) - (~e)*(~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x))⨸((~e)^2 + (~b)^2*(~c)^2*log((~F))^2) : nothing))

("4_7_7_2",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*cos((~!d) + (~!e)*(~x)),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) ?
(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* cos((~d) + (~e)*(~x))⨸((~e)^2 + (~b)^2*(~c)^2*log((~F))^2) + (~e)*(~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x))⨸((~e)^2 + (~b)^2*(~c)^2*log((~F))^2) : nothing))

("4_7_7_3",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    gt((~n), 1) ?
(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* sin((~d) + (~e)*(~x))^(~n)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2) - (~e)*(~n)*(~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x))* sin((~d) + (~e)*(~x))^((~n) - 1)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2) + ((~n)*((~n) - 1)*(~e)^2)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2)* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x))^((~n) - 2), (~x)) : nothing))

("4_7_7_4",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*cos((~!d) + (~!e)*(~x))^(~m),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2*(~m)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    gt((~m), 1) ?
(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* cos((~d) + (~e)*(~x))^(~m)⨸((~e)^2*(~m)^2 + (~b)^2*(~c)^2*log((~F))^2) + (~e)*(~m)*(~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x))* cos((~d) + (~e)*(~x))^((~m) - 1)⨸((~e)^2*(~m)^2 + (~b)^2*(~c)^2*log((~F))^2) + ((~m)*((~m) - 1)*(~e)^2)⨸((~e)^2*(~m)^2 + (~b)^2*(~c)^2*log((~F))^2)* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x))^((~m) - 2), (~x)) : nothing))

("4_7_7_5",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~e)^2*((~n) + 2)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    !eq((~n), -1) &&
    !eq((~n), -2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* sin((~d) + (~e)*(~x))^((~n) + 2)⨸((~e)^2*((~n) + 1)*((~n) + 2)) + (~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x))*sin((~d) + (~e)*(~x))^((~n) + 1)⨸((~e)*((~n) + 1)) : nothing))

("4_7_7_6",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*cos((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~e)^2*((~n) + 2)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    !eq((~n), -1) &&
    !eq((~n), -2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* cos((~d) + (~e)*(~x))^((~n) + 2)⨸((~e)^2*((~n) + 1)*((~n) + 2)) - (~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x))*cos((~d) + (~e)*(~x))^((~n) + 1)⨸((~e)*((~n) + 1)) : nothing))

("4_7_7_7",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2*((~n) + 2)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    lt((~n), -1) &&
    !eq((~n), -2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* sin((~d) + (~e)*(~x))^((~n) + 2)⨸((~e)^2*((~n) + 1)*((~n) + 2)) + (~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x))*sin((~d) + (~e)*(~x))^((~n) + 1)⨸((~e)*((~n) + 1)) + ((~e)^2*((~n) + 2)^2 + (~b)^2*(~c)^2*log((~F))^2)⨸((~e)^2*((~n) + 1)*((~n) + 2))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x))^((~n) + 2), (~x)) : nothing))

("4_7_7_8",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*cos((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2*((~n) + 2)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    lt((~n), -1) &&
    !eq((~n), -2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* cos((~d) + (~e)*(~x))^((~n) + 2)⨸((~e)^2*((~n) + 1)*((~n) + 2)) - (~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x))*cos((~d) + (~e)*(~x))^((~n) + 1)⨸((~e)*((~n) + 1)) + ((~e)^2*((~n) + 2)^2 + (~b)^2*(~c)^2*log((~F))^2)⨸((~e)^2*((~n) + 1)*((~n) + 2))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x))^((~n) + 2), (~x)) : nothing))

# ("4_7_7_9",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x))^(~n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
#     !(ext_isinteger((~n))) ?
# ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))*sin((~d) + (~e)*(~x))^(~n)⨸(-1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n)* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*(-1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n)⨸ℯ^((~I)*(~n)*((~d) + (~e)*(~x))), (~x)) : nothing)
# 
# ("4_7_7_10",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*cos((~!d) + (~!e)*(~x))^(~n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
#     !(ext_isinteger((~n))) ?
# ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))*cos((~d) + (~e)*(~x))^(~n)⨸(1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n)* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*(1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n)⨸ℯ^((~I)*(~n)*((~d) + (~e)*(~x))), (~x)) : nothing)
# 
# ("4_7_7_11",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*tan((~!d) + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     ext_isinteger((~n)) ?
# (~I)^(~n)*∫( ext_expand( (~F)^((~c)*((~a) + (~b)*(~x)))*(1 - ℯ^(2*(~I)*((~d) + (~e)*(~x))))^ (~n)⨸(1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n), (~x)), (~x)) : nothing)

("4_7_7_12",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*cot((~!d) + (~!e)*(~x))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    ext_isinteger((~n)) ?
(-(~I))^(~n)* ∫(ext_expand( (~F)^((~c)*((~a) + (~b)*(~x)))*(1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^ (~n)⨸(1 - ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n), (~x)), (~x)) : nothing))

("4_7_7_13",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sec((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    lt((~n), -1) ?
(~b)*(~c)*log((~F))* (~F)^((~c)*((~a) + (~b)*(~x)))*(sec((~d) + (~e)*(~x))^(~n)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2)) - (~e)*(~n)*(~F)^((~c)*((~a) + (~b)*(~x)))* sec((~d) + (~e)*(~x))^((~n) + 1)*(sin((~d) + (~e)*(~x))⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2)) + (~e)^2*(~n)*(((~n) + 1)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*sec((~d) + (~e)*(~x))^((~n) + 2), (~x)) : nothing))

("4_7_7_14",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*csc((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2, 0) &&
    lt((~n), -1) ?
(~b)*(~c)*log((~F))* (~F)^((~c)*((~a) + (~b)*(~x)))*(csc((~d) + (~e)*(~x))^(~n)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2)) + (~e)*(~n)*(~F)^((~c)*((~a) + (~b)*(~x)))* csc((~d) + (~e)*(~x))^((~n) + 1)*(cos((~d) + (~e)*(~x))⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2)) + (~e)^2*(~n)*(((~n) + 1)⨸((~e)^2*(~n)^2 + (~b)^2*(~c)^2*log((~F))^2))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*csc((~d) + (~e)*(~x))^((~n) + 2), (~x)) : nothing))

("4_7_7_15",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sec((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~b)^2*(~c)^2*log((~F))^2 + (~e)^2*((~n) - 2)^2, 0) &&
    !eq((~n), 1) &&
    !eq((~n), 2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* sec((~d) + (~e)*(~x))^((~n) - 2)⨸((~e)^2*((~n) - 1)*((~n) - 2)) + (~F)^((~c)*((~a) + (~b)*(~x)))*sec((~d) + (~e)*(~x))^((~n) - 1)*sin((~d) + (~e)*(~x))⨸((~e)*((~n) - 1)) : nothing))

("4_7_7_16",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*csc((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~b)^2*(~c)^2*log((~F))^2 + (~e)^2*((~n) - 2)^2, 0) &&
    !eq((~n), 1) &&
    !eq((~n), 2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* csc((~d) + (~e)*(~x))^((~n) - 2)⨸((~e)^2*((~n) - 1)*((~n) - 2)) + (~F)^((~c)*((~a) + (~b)*(~x)))*csc((~d) + (~e)*(~x))^((~n) - 1)*cos((~d) + (~e)*(~x))⨸((~e)*((~n) - 1)) : nothing))

("4_7_7_17",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sec((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~b)^2*(~c)^2*log((~F))^2 + (~e)^2*((~n) - 2)^2, 0) &&
    gt((~n), 1) &&
    !eq((~n), 2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* sec((~d) + (~e)*(~x))^((~n) - 2)⨸((~e)^2*((~n) - 1)*((~n) - 2)) + (~F)^((~c)*((~a) + (~b)*(~x)))*sec((~d) + (~e)*(~x))^((~n) - 1)*sin((~d) + (~e)*(~x))⨸((~e)*((~n) - 1)) + ((~e)^2*((~n) - 2)^2 + (~b)^2*(~c)^2*log((~F))^2)⨸((~e)^2*((~n) - 1)*((~n) - 2))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*sec((~d) + (~e)*(~x))^((~n) - 2), (~x)) : nothing))

("4_7_7_18",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*csc((~!d) + (~!e)*(~x))^(~n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~b)^2*(~c)^2*log((~F))^2 + (~e)^2*((~n) - 2)^2, 0) &&
    gt((~n), 1) &&
    !eq((~n), 2) ?
-(~b)*(~c)*log((~F))*(~F)^((~c)*((~a) + (~b)*(~x)))* csc((~d) + (~e)*(~x))^((~n) - 2)⨸((~e)^2*((~n) - 1)*((~n) - 2)) - (~F)^((~c)*((~a) + (~b)*(~x)))*csc((~d) + (~e)*(~x))^((~n) - 1)*cos((~d) + (~e)*(~x))⨸((~e)*((~n) - 1)) + ((~e)^2*((~n) - 2)^2 + (~b)^2*(~c)^2*log((~F))^2)⨸((~e)^2*((~n) - 1)*((~n) - 2))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*csc((~d) + (~e)*(~x))^((~n) - 2), (~x)) : nothing))

#(* Int[F_^(c_.*(a_.+b_.*x_))*Sec[d_.+e_.*x_]^n_.,x_Symbol] := 2^n*Int[SimplifyIntegrand[F^(c*(a+b*x))*E^(I*n*(d+e*x))/(1+E^(2*I*( d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e},x] && IntegerQ[n] *)
#(* Int[F_^(c_.*(a_.+b_.*x_))*Csc[d_.+e_.*x_]^n_.,x_Symbol] := (2*I)^n*Int[SimplifyIntegrand[F^(c*(a+b*x))*E^(-I*n*(d+e*x))/(1-E^(- 2*I*(d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e},x] && IntegerQ[n] *)
# ("4_7_7_19",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sec((~!d) + (~!k)*π + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     ext_isinteger(4*(~k)) &&
#     ext_isinteger((~n)) ?
# 2^(~n)*ℯ^((~I)*(~k)*(~n)*π)*ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))* (~F)^((~c)*((~a) + (~b)*(~x)))⨸((~I)*(~e)*(~n) + (~b)*(~c)*log((~F)))* hypergeometric2f1((~n), (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), 1 + (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), -ℯ^(2*(~I)*(~k)*π)*ℯ^(2*(~I)*((~d) + (~e)*(~x)))) : nothing)
# 
# ("4_7_7_20",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sec((~!d) + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     ext_isinteger((~n)) ?
# 2^(~n)*ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))*(~F)^((~c)*((~a) + (~b)*(~x)))⨸((~I)*(~e)*(~n) + (~b)*(~c)*log((~F)))* hypergeometric2f1((~n), (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), 1 + (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), -ℯ^(2*(~I)*((~d) + (~e)*(~x)))) : nothing)
# 
# ("4_7_7_21",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*csc((~!d) + (~!k)*π + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     ext_isinteger(4*(~k)) &&
#     ext_isinteger((~n)) ?
# (-2*(~I))^(~n)*ℯ^((~I)*(~k)*(~n)*π)* ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))*((~F)^((~c)*((~a) + (~b)*(~x)))⨸((~I)*(~e)*(~n) + (~b)*(~c)*log((~F))))* hypergeometric2f1((~n), (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), 1 + (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), ℯ^(2*(~I)*(~k)*π)*ℯ^(2*(~I)*((~d) + (~e)*(~x)))) : nothing)
# 
# ("4_7_7_22",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*csc((~!d) + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     ext_isinteger((~n)) ?
# (-2*(~I))^(~n)*ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))*((~F)^((~c)*((~a) + (~b)*(~x)))⨸((~I)*(~e)*(~n) + (~b)*(~c)*log((~F))))* hypergeometric2f1((~n), (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), 1 + (~n)⨸2 - (~I)*(~b)*(~c)*log((~F))⨸(2*(~e)), ℯ^(2*(~I)*((~d) + (~e)*(~x)))) : nothing)
# 
# ("4_7_7_23",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sec((~!d) + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     !(ext_isinteger((~n))) ?
# (1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n)*sec((~d) + (~e)*(~x))^(~n)⨸ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))* ∫(ext_simplify( (~F)^((~c)*((~a) + (~b)*(~x)))*ℯ^((~I)*(~n)*((~d) + (~e)*(~x)))⨸(1 + ℯ^(2*(~I)*((~d) + (~e)*(~x))))^(~n), (~x)), (~x)) : nothing)
# 
# ("4_7_7_24",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*csc((~!d) + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     !(ext_isinteger((~n))) ?
# (1 - ℯ^(-2*(~I)*((~d) + (~e)*(~x))))^(~n)*csc((~d) + (~e)*(~x))^(~n)⨸ℯ^(-(~I)*(~n)*((~d) + (~e)*(~x)))* ∫(ext_simplify( (~F)^((~c)*((~a) + (~b)*(~x)))*ℯ^(-(~I)*(~n)*((~d) + (~e)*(~x)))⨸(1 - ℯ^(-2*(~I)*((~d) + (~e)*(~x))))^(~n), (~x)), (~x)) : nothing)

("4_7_7_25",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~f) + (~!g)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~f)^2 - (~g)^2, 0) &&
    ilt((~n), 0) ?
2^(~n)*(~f)^(~n)* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d)⨸2 - (~f)*π⨸(4*(~g)) + (~e)*(~x)⨸2)^(2*(~n)), (~x)) : nothing))

("4_7_7_26",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~f) + (~!g)*cos((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~f) - (~g), 0) &&
    ilt((~n), 0) ?
2^(~n)*(~f)^(~n)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d)⨸2 + (~e)*(~x)⨸2)^(2*(~n)), (~x)) : nothing))

("4_7_7_27",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~f) + (~!g)*cos((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~f) + (~g), 0) &&
    ilt((~n), 0) ?
2^(~n)*(~f)^(~n)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d)⨸2 + (~e)*(~x)⨸2)^(2*(~n)), (~x)) : nothing))

("4_7_7_28",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~f) + (~!g)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~x)) &&
    eq((~f)^2 - (~g)^2, 0) &&
    !(ext_isinteger((~n))) ?
((~f) + (~g)*sin((~d) + (~e)*(~x)))^(~n)⨸cos((~d)⨸2 - (~f)*π⨸(4*(~g)) + (~e)*(~x)⨸2)^(2*(~n))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d)⨸2 - (~f)*π⨸(4*(~g)) + (~e)*(~x)⨸2)^(2*(~n)), (~x)) : nothing))

("4_7_7_29",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~f) + (~!g)*cos((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~x)) &&
    eq((~f) - (~g), 0) &&
    !(ext_isinteger((~n))) ?
((~f) + (~g)*cos((~d) + (~e)*(~x)))^(~n)⨸cos((~d)⨸2 + (~e)*(~x)⨸2)^(2*(~n))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d)⨸2 + (~e)*(~x)⨸2)^(2*(~n)), (~x)) : nothing))

("4_7_7_30",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~f) + (~!g)*cos((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~x)) &&
    eq((~f) + (~g), 0) &&
    !(ext_isinteger((~n))) ?
((~f) + (~g)*cos((~d) + (~e)*(~x)))^(~n)⨸sin((~d)⨸2 + (~e)*(~x)⨸2)^(2*(~n))* ∫((~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d)⨸2 + (~e)*(~x)⨸2)^(2*(~n)), (~x)) : nothing))

("4_7_7_31",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))* cos((~!d) + (~!e)*(~x))^(~!m)*((~f) + (~!g)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~f)^2 - (~g)^2, 0) &&
    ext_isinteger((~m), (~n)) &&
    eq((~m) + (~n), 0) ?
(~g)^(~n)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*tan((~f)*π⨸(4*(~g)) - (~d)⨸2 - (~e)*(~x)⨸2)^(~m), (~x)) : nothing))

("4_7_7_32",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))* sin((~!d) + (~!e)*(~x))^(~!m)*((~f) + (~!g)*cos((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~f) - (~g), 0) &&
    ext_isinteger((~m), (~n)) &&
    eq((~m) + (~n), 0) ?
(~f)^(~n)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*tan((~d)⨸2 + (~e)*(~x)⨸2)^(~m), (~x)) : nothing))

("4_7_7_33",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))* sin((~!d) + (~!e)*(~x))^(~!m)*((~f) + (~!g)*cos((~!d) + (~!e)*(~x)))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~f) + (~g), 0) &&
    ext_isinteger((~m), (~n)) &&
    eq((~m) + (~n), 0) ?
(~f)^(~n)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*cot((~d)⨸2 + (~e)*(~x)⨸2)^(~m), (~x)) : nothing))

("4_7_7_34",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~h) + (~!i)*cos((~!d) + (~!e)*(~x)))/((~f) + (~!g)*sin((~!d) + (~!e)*(~x))),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~x)) &&
    eq((~f)^2 - (~g)^2, 0) &&
    eq((~h)^2 - (~i)^2, 0) &&
    eq((~g)*(~h) - (~f)*(~i), 0) ?
2*(~i)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*(cos((~d) + (~e)*(~x))⨸((~f) + (~g)*sin((~d) + (~e)*(~x)))), (~x)) + ∫((~F)^((~c)*((~a) + (~b)*(~x)))*(((~h) - (~i)*cos((~d) + (~e)*(~x)))⨸((~f) + (~g)*sin((~d) + (~e)*(~x)))), (~x)) : nothing))

("4_7_7_35",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*((~h) + (~!i)*sin((~!d) + (~!e)*(~x)))/((~f) + (~!g)*cos((~!d) + (~!e)*(~x))),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~x)) &&
    eq((~f)^2 - (~g)^2, 0) &&
    eq((~h)^2 - (~i)^2, 0) &&
    eq((~g)*(~h) + (~f)*(~i), 0) ?
2*(~i)*∫((~F)^((~c)*((~a) + (~b)*(~x)))*(sin((~d) + (~e)*(~x))⨸((~f) + (~g)*cos((~d) + (~e)*(~x)))), (~x)) + ∫((~F)^((~c)*((~a) + (~b)*(~x)))*(((~h) - (~i)*sin((~d) + (~e)*(~x)))⨸((~f) + (~g)*cos((~d) + (~e)*(~x)))), (~x)) : nothing))

("4_7_7_36",
:(∫((~F)^((~!c)*(~u))*(~G)((~v))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~c), (~n), (~x)) &&
    istrig((~G)) &&
    linear((~u), (~v), (~x)) &&
    !(linear_without_simplify((~u), (~v), (~x))) ?
∫((~F)^((~c)*expand_to_sum((~u), (~x)))*(~G)(expand_to_sum((~v), (~x)))^(~n), (~x)) : nothing))

# Rule skipped because of "Module":
# Int[(f_.*x_)^m_.*F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^n_., x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Sin[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]

# Rule skipped because of "Module":
# Int[(f_.*x_)^m_.*F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_]^n_., x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Cos[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]

("4_7_7_39",
:(∫(((~!f)*(~x))^(~m)*(~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x)),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~m), (~x)) &&
    (
        lt((~m), -1) ||
        sumsimpler((~m), 1)
    ) ?
((~f)*(~x))^((~m) + 1)⨸((~f)*((~m) + 1))*(~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x)) - (~e)⨸((~f)*((~m) + 1))* ∫(((~f)*(~x))^((~m) + 1)*(~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x)), (~x)) - (~b)*(~c)*log((~F))⨸((~f)*((~m) + 1))* ∫(((~f)*(~x))^((~m) + 1)*(~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x)), (~x)) : nothing))

("4_7_7_40",
:(∫(((~!f)*(~x))^(~m)*(~F)^((~!c)*((~!a) + (~!b)*(~x)))*cos((~!d) + (~!e)*(~x)),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~m), (~x)) &&
    (
        lt((~m), -1) ||
        sumsimpler((~m), 1)
    ) ?
((~f)*(~x))^((~m) + 1)⨸((~f)*((~m) + 1))*(~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x)) + (~e)⨸((~f)*((~m) + 1))* ∫(((~f)*(~x))^((~m) + 1)*(~F)^((~c)*((~a) + (~b)*(~x)))*sin((~d) + (~e)*(~x)), (~x)) - (~b)*(~c)*log((~F))⨸((~f)*((~m) + 1))* ∫(((~f)*(~x))^((~m) + 1)*(~F)^((~c)*((~a) + (~b)*(~x)))*cos((~d) + (~e)*(~x)), (~x)) : nothing))

#(* Int[(f_.*x_)^m_.*F_^(c_.*(a_.+b_.*x_))*Sin[d_.+e_.*x_]^n_.,x_ Symbol] := I^n/2^n*Int[ExpandIntegrand[(f*x)^m*F^(c*(a+b*x)),(E^(-I*(d+e*x))-E^ (I*(d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e,f},x] && IGtQ[n,0] *)
#(* Int[(f_.*x_)^m_.*F_^(c_.*(a_.+b_.*x_))*Cos[d_.+e_.*x_]^n_.,x_ Symbol] := 1/2^n*Int[ExpandIntegrand[(f*x)^m*F^(c*(a+b*x)),(E^(-I*(d+e*x))+E^( I*(d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e,f},x] && IGtQ[n,0] *)
("4_7_7_41",
:(∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x))^(~!m)* cos((~!f) + (~!g)*(~x))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    igt((~m), 0) &&
    igt((~n), 0) ?
∫(expand_trig_reduce((~F)^((~c)*((~a) + (~b)*(~x))), sin((~d) + (~e)*(~x))^(~m)*cos((~f) + (~g)*(~x))^(~n), (~x)), (~x)) : nothing))

("4_7_7_42",
:(∫((~x)^(~!p)*(~F)^((~!c)*((~!a) + (~!b)*(~x)))*sin((~!d) + (~!e)*(~x))^(~!m)* cos((~!f) + (~!g)*(~x))^(~!n),(~x)) ) => :(
    !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    igt((~m), 0) &&
    igt((~n), 0) &&
    igt((~p), 0) ?
∫(expand_trig_reduce((~x)^(~p)*(~F)^((~c)*((~a) + (~b)*(~x))), sin((~d) + (~e)*(~x))^(~m)*cos((~f) + (~g)*(~x))^(~n), (~x)), (~x)) : nothing))

# ("4_7_7_43",
# @rule ∫((~F)^((~!c)*((~!a) + (~!b)*(~x)))*(~G)((~!d) + (~!e)*(~x))^(~!m)*(~H)((~!d) + (~!e)*(~x))^(~!n),(~x)) =>
#     !contains_var((~F), (~a), (~b), (~c), (~d), (~e), (~x)) &&
#     igt((~m), 0) &&
#     igt((~n), 0) &&
#     istrig((~G)) &&
#     istrig((~H)) ?
# ∫(ExpandTrigToExp[(~F)^((~c)*((~a) + (~b)*(~x))), (~G)((~d) + (~e)*(~x))^(~m)*(~H)((~d) + (~e)*(~x))^(~n), (~x)], (~x)) : nothing)
# 
# ("4_7_7_44",
# @rule ∫((~F)^(~u)*sin((~v))^(~!n),(~x)) =>
#     !contains_var((~F), (~x)) &&
#     (
#         linear((~u), (~x)) ||
#         poly((~u), (~x), 2)
#     ) &&
#     (
#         linear((~v), (~x)) ||
#         poly((~v), (~x), 2)
#     ) &&
#     igt((~n), 0) ?
# ∫(ExpandTrigToExp[(~F)^(~u), sin((~v))^(~n), (~x)], (~x)) : nothing)
# 
# ("4_7_7_45",
# @rule ∫((~F)^(~u)*cos((~v))^(~!n),(~x)) =>
#     !contains_var((~F), (~x)) &&
#     (
#         linear((~u), (~x)) ||
#         poly((~u), (~x), 2)
#     ) &&
#     (
#         linear((~v), (~x)) ||
#         poly((~v), (~x), 2)
#     ) &&
#     igt((~n), 0) ?
# ∫(ExpandTrigToExp[(~F)^(~u), cos((~v))^(~n), (~x)], (~x)) : nothing)
# 
# ("4_7_7_46",
# @rule ∫((~F)^(~u)*sin((~v))^(~!m)*cos((~v))^(~!n),(~x)) =>
#     !contains_var((~F), (~x)) &&
#     (
#         linear((~u), (~x)) ||
#         poly((~u), (~x), 2)
#     ) &&
#     (
#         linear((~v), (~x)) ||
#         poly((~v), (~x), 2)
#     ) &&
#     igt((~m), 0) &&
#     igt((~n), 0) ?
# ∫(ExpandTrigToExp[(~F)^(~u), sin((~v))^(~m)*cos((~v))^(~n), (~x)], (~x)) : nothing)


]
